<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- displays site properly based on user's device -->

  <link rel="icon" type="image/png" sizes="32x32" href="./images/favicon-32x32.png">
  <link rel="stylesheet" href="reset.css">
  <link rel="stylesheet" href="styles.css">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kumbh+Sans:wght@400;700&display=swap" rel="stylesheet">
  
  <title>Frontend Mentor | E-commerce product page</title>

  <!-- Feel free to remove these styles or customise in your own stylesheet 👍 -->
  <style>
    .attribution { font-size: 11px; text-align: center; }
    .attribution a { color: hsl(228, 45%, 44%); }
  </style>
</head>
<body>

  <header>
    <nav>
      <img src="/images/icon-menu.svg" alt="" id='accordion'>
      <img src="/images/logo.svg" alt="" id='logo'>
      <a href='#' class='nav-links hidden'>Collections</a>
      <a href='#' class='nav-links hidden'>Men</a>
      <a href='#' class='nav-links hidden'>Women</a>
      <a href='#' class='nav-links hidden'>About</a>
      <a href='#' class='nav-links hidden'>Contact</a>
    </nav>

    <div id='cart-prof-pic'>
      <img src="images/icon-cart.svg" alt="" id='cart-icon' onClick='toggleModal()'>
      <span id='cart-quantity' onClick='toggleModal()''></span>
      <img src="images/image-avatar.png" alt="" id='profile-pic'>
    </div>
  </header>

  <div id='image-carousel'>
    <!-- <a href="#" class='carousel-nav' id='prev'><img src="images/icon-previous.svg" alt=""></a>
    <a href="#" class='carousel-nav' id='next'><img src="images/icon-next.svg" alt=""></a> -->
    <img src="images/image-product-1.jpg" alt="" class='image-full'>
  </div>

  <main>

  <span id='company-name'>Sneaker Company</span> 

  <h1>Fall Limited Edition Sneakers</h1>

  <p>These low-profile sneakers are your perfect casual wear companion. Featuring a 
  durable rubber outer sole, they’ll withstand everything the weather can offer.</p> 

  <div id='price'>
    <div id='sale-percent-container'>
      <span id='sale-price'>$<span>125.00</span></span>
    <div id='percent-container'>
      <span id='sale-percent'>50%</span> 
    </div>
    </div>
    <span id='retail-price'>$250.00</span> 
  </div>

  <div class='center'>
    <div id='purchase-quantity'>
      <div id='decrement' class='inc-dec'  onClick='handleQuantity(-1)'>
        <img src="images/icon-minus.svg" alt="">
      </div>
      <div id='quantity'>0</div>
      <div id='increment' class='inc-dec' onClick='handleQuantity(1)'>
        <img src="images/icon-plus.svg" alt="">
      </div>
    </div>
  </div>


  <div class='center'>
    <button onClick='addToCart()' id='add-to-cart-button' disabled><img src="images/icon-cart.svg" alt=""> <span id='add-to-cart'>Add to cart</span></button>
  </div>
  </main>

  <div id='modal' class='cart-modal'>
    <div id='modal-title'><h2>Cart</h2></div>
    <div id='item-container'></div>
    <div id='cart-empty'>Your cart is empty.</div>
    <button id='checkout-button'>Checkout</button>
  </div>

  <div class="attribution">
    Challenge by <a href="https://www.frontendmentor.io?ref=challenge" target="_blank">Frontend Mentor</a>. 
    Coded by <a href="https://www.frontendmentor.io/profile/CMikeZeltner">CMikeZeltner</a>.
  </div>

  <script>
    document.querySelectorAll('.inc-dec').forEach(element => {
      element.addEventListener('click', () => {
        const addButton = document.getElementById('add-to-cart-button')
        const addSpan = document.getElementById('quantity')
        if(addSpan.innerHTML === '0'){
          addButton.disabled = true
          addButton.style.backgroundColor = 'hsla(26, 100%, 55%, 0.4)'
        } else {
          addButton.disabled = false
          addButton.style.backgroundColor = 'hsl(26, 100%, 55%)'
        }
      })
    });

    function handleQuantity(action) {
      let num = parseInt(document.getElementById('quantity').innerHTML)
      if(action === -1 && num > 0){
        num -= 1
      } else if (action === 1) {
        num += 1
      }

      document.getElementById('quantity').innerHTML = num
    }

    function toggleModal() {
      const modal = document.getElementById('modal')
      if(document.getElementById('modal').style.display == 'block'){
        document.getElementById('modal').style.display = 'none'
      } else{
        document.getElementById('modal').style.display = 'block'
      }
    }

    function addToCart(){
      createCartEntry()

      const modal = document.getElementById('modal')

    //Add button if this is the first cart item
    document.getElementById('checkout-button').style.display = 'block'
    }

    function createCartEntry() {
      const modal = document.getElementById('item-container')

      //Get Price and Product info for template literals
      const quantity = parseInt(document.getElementById('quantity').innerHTML)
      const price = parseInt(document.getElementById('sale-price').children[0].innerHTML)
      const total = quantity * price
      const name = document.querySelector('h1').innerHTML

      document.getElementById('cart-empty').style.display = 'none'
      
      let id = getID()
      if(id === -1){
        id = 1
      }

      modal.innerHTML += `<div class='modal-main' id='${id}'>
      <img src="images/image-product-1-thumbnail.jpg" alt="" class='cart-thumbnail'>
      <div class='modal-product-info'>
      <span class='item-name'>${name}</span>
      <div class='math-total-price-container'>
        <span class='math'>$${price} x ${quantity}</span>
      <span class='total-price'>$${total}</span>
      </div>
      </div>
      <img src="images/icon-delete.svg" alt="" class='trash-icon' onClick=deleteItem(${id})>
      </div>`

      const cartQuantity = document.getElementById('cart-quantity')
      cartQuantity.style.display = 'inline'
      cartQuantity.innerHTML = id

    }


    function getID() {
      const items = document.querySelectorAll('.modal-main')
      try {
        const id = parseInt(items[items.length - 1].id)
        return id + 1
      } catch (error) {
        return -1
      }
      
    }


    function deleteItem(id){
      const item = document.getElementById(id)
      item.remove()

      const containerEmpty = document.getElementById('item-container')
      if(containerEmpty.childNodes.length === 0){
        document.getElementById('cart-empty').style.display = 'block'
        document.getElementById('checkout-button').style.display = 'none'
        document.getElementById('cart-quantity').style.display = 'none'
      } else {
        document.getElementById('cart-quantity').innerHTML = document.querySelectorAll('.modal-main').length
        console.log(`doc: ${document.querySelectorAll('modal-main').length + 1}`)
      }
      
    }
  </script>
</body>
</html>